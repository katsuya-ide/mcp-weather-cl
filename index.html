<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Inter%3Awght%40400%3B500%3B700%3B900&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
    />

    <title>Stitch Design</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  </head>
  <body>
    <div class="relative flex size-full min-h-screen flex-col bg-[#1f1c14] dark group/design-root overflow-x-hidden" style='font-family: Inter, "Noto Sans", sans-serif;'>
      <div class="layout-container flex h-full grow flex-col">
        <header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#413b2a] px-10 py-3">
          <div class="flex items-center gap-4 text-white">
            <div class="size-4">
              <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M24 4H6V17.3333V30.6667H24V44H42V30.6667V17.3333H24V4Z" fill="currentColor"></path>
              </svg>
            </div>
            <h2 class="text-white text-lg font-bold leading-tight tracking-[-0.015em]">Weather App</h2>
          </div>
          <div class="flex flex-1 justify-end gap-8">
            <div class="flex items-center gap-9">
              <a class="text-white text-sm font-medium leading-normal" href="#">Home</a>
              <a class="text-white text-sm font-medium leading-normal" href="#">About</a>
              <a class="text-white text-sm font-medium leading-normal" href="#">Contact</a>
            </div>
            <button
              class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 bg-[#413b2a] text-white gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5"
            >
              <div class="text-white" data-icon="Bell" data-size="20px" data-weight="regular">
                <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor" viewBox="0 0 256 256">
                  <path
                    d="M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216ZM48,184c7.7-13.24,16-43.92,16-80a64,64,0,1,1,128,0c0,36.05,8.28,66.73,16,80Z"
                  ></path>
                </svg>
              </div>
            </button>
            <div
              class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10"
              style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDtUNzptg8xkx4xoch2Tg3iShe57vi-iDhce6dIs4xv-tq4AoUDF8gCdZmXvOlwGQiinCxVu5wdy5WL70OqJ4SHIdqi7yxUa6G-6zu19nAYbNIe_0Vt9WqbLqLN3in2jFX1TRh5uUFrjxWuFSSJ_wak4w2k1Erht5PnvxRaEdyTH5BiVVLLsuAS1GW4fAzypjMjkm_DU6NpuPYbwfevrdVL2vtKo6tHh75wHxHCZKV66soI1xjO-dEvBky7ka3ahsd4SPoUwUYevos");'
            ></div>
          </div>
        </header>
        <div class="px-40 flex flex-1 justify-center py-5">
          <div class="layout-content-container flex flex-col max-w-[960px] flex-1">
            <h2 class="text-white tracking-light text-[28px] font-bold leading-tight px-4 text-center pb-3 pt-5">Get Weather Information</h2>
            <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
              <label class="flex flex-col min-w-40 flex-1">
                <input
                  id="cityInput"
                  placeholder="Enter city name"
                  class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-white focus:outline-0 focus:ring-0 border border-[#5d543c] bg-[#2f2a1e] focus:border-[#5d543c] h-14 placeholder:text-[#bfb69b] p-[15px] text-base font-normal leading-normal"
                  value=""
                />
              </label>
            </div>
            <div class="flex px-4 py-3 justify-center">
              <button
                id="getWeatherBtn"
                class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#f9f5ea] text-[#1f1c14] text-sm font-bold leading-normal tracking-[0.015em]"
              >
                <span class="truncate">Get Weather</span>
              </button>
            </div>
            <h2 class="text-white text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">Weather Information</h2>
            <div id="weatherInfo" class="p-4 grid grid-cols-[20%_1fr] gap-x-6">
              <div class="col-span-2 grid grid-cols-subgrid border-t border-t-[#5d543c] py-5">
                <p class="text-[#bfb69b] text-sm font-normal leading-normal">Temperature</p>
                <p id="temperature" class="text-white text-sm font-normal leading-normal">--</p>
              </div>
              <div class="col-span-2 grid grid-cols-subgrid border-t border-t-[#5d543c] py-5">
                <p class="text-[#bfb69b] text-sm font-normal leading-normal">Rain %</p>
                <p id="humidity" class="text-white text-sm font-normal leading-normal">--</p>
              </div>
              <div class="col-span-2 grid grid-cols-subgrid border-t border-t-[#5d543c] py-5">
                <p class="text-[#bfb69b] text-sm font-normal leading-normal">Conditions</p>
                <p id="conditions" class="text-white text-sm font-normal leading-normal">--</p>
              </div>
              <div class="col-span-2 grid grid-cols-subgrid border-t border-t-[#5d543c] py-5">
                <p class="text-[#bfb69b] text-sm font-normal leading-normal">Description</p>
                <p id="description" class="text-white text-sm font-normal leading-normal">--</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script>
      // Weather API client functionality
      class WeatherClient {
        constructor() {
          this.initializeEventListeners();
        }

        initializeEventListeners() {
          const getWeatherBtn = document.getElementById('getWeatherBtn');
          const cityInput = document.getElementById('cityInput');

          getWeatherBtn.addEventListener('click', () => {
            this.getWeather();
          });

          cityInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
              this.getWeather();
            }
          });
        }

        async getWeather() {
          const cityInput = document.getElementById('cityInput');
          const city = cityInput.value.trim();

          if (!city) {
            alert('都市名を入力してください');
            return;
          }

          try {
            // Show loading state
            this.showLoading();

            // Call the weather API endpoint
            const response = await fetch('/api/weather', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify({ city: city })
            });

            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }

            const weatherData = await response.json();
            this.displayWeather(weatherData);

          } catch (error) {
            console.error('天気情報の取得に失敗しました:', error);
            this.showError('天気情報の取得に失敗しました。もう一度お試しください。');
          }
        }

        showLoading() {
          document.getElementById('temperature').textContent = '読み込み中...';
          document.getElementById('humidity').textContent = '読み込み中...';
          document.getElementById('conditions').textContent = '読み込み中...';
          document.getElementById('description').textContent = '読み込み中...';
        }

        showError(message) {
          document.getElementById('temperature').textContent = 'エラー';
          document.getElementById('humidity').textContent = 'エラー';
          document.getElementById('conditions').textContent = 'エラー';
          document.getElementById('description').textContent = message;
        }

        displayWeather(data) {
          console.log('Received weather data:', JSON.stringify(data, null, 2));
          
          // Ensure we have valid data
          if (!data || typeof data !== 'object') {
            console.error('Invalid weather data received:', data);
            this.showError('無効なデータを受信しました');
            return;
          }
          
          // Update the display with the received data
          document.getElementById('temperature').textContent = data.temperature || data.temp || '--';
          document.getElementById('humidity').textContent = data.humidity || '--';
          document.getElementById('conditions').textContent = data.conditions || data.weather || data.condition || '--';
          document.getElementById('description').textContent = data.description || `Weather information for ${data.city || 'Unknown city'}`;
        }
      }

      // Initialize the weather client when the page loads
      document.addEventListener('DOMContentLoaded', () => {
        new WeatherClient();
      });
    </script>
  </body>
</html>
